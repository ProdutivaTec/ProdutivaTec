<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard</title>
    <link rel="stylesheet" href="./css/dashboard-VisãoGestor.css">
    <link rel="stylesheet" href="./css/notificações.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="shortcut icon" type="imagex/png" href="./assets/img/ABA.ico">

</head>

<body onload="validarSessao()">
    <section class="container">
        <aside class="sidebar">
            <div class="imgDash" id="theme-dash">
                <img src="./assets/img/LOGO.png" id="theme-logo" alt="Logo">
            </div>
            <br>
            <div class="divMenu">
                <div class="menu-itemAtivo">
                    <img class="icon" src="./assets/icon/Dash.png" alt="Dashboards Icon">
                    Dashboard
                </div>
                <a href="./calendario.html">
                    <div class="menu-item">
                        <img class="icon" src="./assets/icon/calendario (1) 1.png" alt="Suporte - IA Icon">
                        Eventos
                    </div>
                </a>
                <div class="menu-item" onclick="irParaConfiguracoes()">
                    <img class="icon" src="./assets/icon/Configurações.png" alt="Configurações Icon">
                    Configurações
                </div>
            </div>
            <div class="itemExit" onclick="limparSessao()">
                <p class="pSidebar">Sair</p>
                <img class="iconE" src="./assets/icon/Sair.png" alt="Sair Icon">
            </div>
        </aside>

        <div id="myModal" class="modal">
            <div class="modal-content">
                <span class="close">&times;</span>
                <h2>Notificações</h2>
                <table>
                    <tr>
                        <th>Tipo</th>
                        <th>Evento</th>
                        <th>+Notificações</th>
                    </tr>
                    <tr>
                        <td>Feedback Positivo</td>
                        <td>Equipe de Marketing elogiada pela colaboração no projeto X.</td>
                        <td>Ver mais feedbacks positivos sobre a Equipe de Marketing</td>
                    </tr>
                    <tr>
                        <td>Feedback Negativo</td>
                        <td>Alta taxa de insatisfação com o volume de trabalhom</td>
                        <td>Revisar carga de trabalho por departamento</td>
                    </tr>
                    <tr>
                        <td>Feedback Anônimo</td>
                        <td>Sugestão de melhoria no ambiente físico do escritório.</td>
                        <td>Ver todas as sugestões anônimas</td>
                    </tr>
                    <tr>
                    <tr>
                        <td>Reconhecimento</td>
                        <td>Funcionário Y recebeu elogios pela liderança em projeto Z.</td>
                        <td>Ver detalhes do projeto e comentários</td>
                    </tr>
                    <tr>
                    <tr>
                        <td>Sugestão</td>
                        <td>Equipe de TI sugeriu melhorias na comunicação interna.</td>
                        <td>Ver todas as sugestões recentes</td>
                    </tr>
                    <tr>
                    <tr>
                        <td>Engajamento</td>
                        <td>Equipe de Design atingiu alto nível de engajamento nas reuniões semanais.</td>
                        <td>Ver detalhes sobre engajamento na empresa</td>
                    </tr>
                    <tr>

                        <!-- Mais notificações aqui -->
                </table>
            </div>
        </div>

        <header class="headerDash">
            <div class="headerRight">
                <div class="funcionalidadesHeader" id="theme-toggle">
                    <img src="./assets/icon/sun.png" alt="Tema Claro" id="theme-icon">
                </div>
                <div class="vertical"></div>
                <a href="./configuracoesPerfil.html">
                <div class="funcionalidadesHeader" id="theme-header2">
                    <img src="./assets/icon/setting (3).png" id="theme-confg" alt="">
                </div>
            </a>
                <div class="vertical"></div>
                <div class="funcionalidadesHeader" id="theme-header2">
                    <img class="fotoUsuario" id="theme-confg" src="" alt="">
                </div>
            </div>
        </header>

        <section class="graficosDash">
            <div class="textEmpresa">
                <Span class="tittleEmpresa">Financeiro</Span>
                <p class="subtittleEmpresa" id="qtdColaboradores"> colaboradores</p>
            </div>
            <div class="dashTop">
                <div class="area2Kpis">
                    <div class="KPI3">
                        <div class="satisfacao">
                            <img class="imgSexo" src="./assets/icon/banheiro 1.png" alt="">
                            <div class="areaHR">
                                <hr class="hrKPI">
                            </div>
                            <span class="textDados" id="porcentagem-remoto">0%</span>
                            <p class="pTextKPI3">Mais produtivos no <br> trabalho remoto </p>
                        </div>
                    </div>
                    <div class="KPI3">
                        <div class="satisfacao">
                            <img class="imgSexo" src="./assets/icon/banheiro 1.png" alt="">
                            <div class="areaHR">
                                <hr class="hrKPI">
                            </div>
                            <span class="textDados" id="porcentagem-presencial">25%</span>
                            <p class="pTextKPI3"> Mais produtivos no <br> trabalho presencial </p>
                        </div>
                    </div>
                </div>
                <div class="area2Kpis2">
                    <div class="KPI3">
                        <div class="satisfacao">
                            <img class="imgSexo" src="./assets/icon/banheiro 2.png" alt="">
                            <div class="areaHR">
                                <hr class="hrKPI">
                            </div>
                            <span class="textDados" id="porcentagem-remoto-mulher">0%</span>
                            <p class="pTextKPI3">Mais produtivas no <br> trabalho remoto </p>
                        </div>
                    </div>
                    <div class="KPI3">
                        <div class="satisfacao">
                            <img class="imgSexo" src="./assets/icon/banheiro 2.png" alt="">
                            <div class="areaHR">
                                <hr class="hrKPI">
                            </div>
                            <span class="textDados" id="porcentagem-presencial-mulher">25%</span>
                            <p class="pTextKPI3"> Mais produtivas no <br> trabalho presencial </p>
                        </div>
                    </div>
                </div>
                <div class="KPI22">
                    <p class="pTextKPI2">A produtividade média de <br> equipe é de</p>
                    <span class="textDados" id="media-produtividade-equipe">0%</span>
                    <div class="medidor-container">
                        <input type="range" id="medidor" min="0" max="5" step="0.1" value="2">
                        <div class="resultado">
                            <span id="resultadoTexto" class="bom">Bom</span>
                            <span id="valorSlider" class="valor-slider"></span>
                        </div>
                    </div>

                </div>
            </div>
            <div class="KPIbottom">
                <div class="KPI4">
                    <span class="tittleEmpresa"> Utilização de Recursos</span>
                    <p class="pTextKPI2"> Em horas </p>
                    <canvas id="graficoRecursos"></canvas>
                </div>

                <div class="KPI5">
                    <div class="tituloKpi3">
                        <span class="tittleEmpresaG3"> Piores aspectos <br> do trabalho </span>
                        <select class="selectAspectos" name="" id="">
                            <option value="remoto">Remoto</option>
                            <option value="presencial">Presencial</option>
                        </select>
                    </div>
                    <canvas id="GraficoPiorAspecto" width="400" height="300"></canvas>
                </div>
            </div>
            </div>
        </section>
    </section>

</body>

</html>

<script src="./js/dashboardGestor.js"></script>
<script src="./js/modal.js"></script>
<script src="./js/sessao.js"></script>
<script src="./js/atualizarImg-Perfil.js"></script>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels"></script>
 
<script>

    // Requisição para obter a porcentagem de produtividade do trabalho remoto
    fetch('/dashboardGestor/porcentagem-produtivo-remoto')
        .then(response => response.json())
        .then(data => {
            if (data && data.porcentagemRemoto !== undefined) {
                document.getElementById('porcentagem-remoto').textContent = data.porcentagemRemoto + '%';
            }
        })
        .catch(error => console.error('Erro ao buscar a porcentagem do remoto:', error));

    // Requisição para obter a porcentagem de produtividade do trabalho presencial
    fetch('/dashboardGestor/porcentagem-produtivo-presencial')
        .then(response => response.json())
        .then(data => {
            if (data && data.porcentagemPresencial !== undefined) {
                document.getElementById('porcentagem-presencial').textContent = data.porcentagemPresencial + '%';
            }
        })
        .catch(error => console.error('Erro ao buscar a porcentagem do presencial:', error));

    // Requisição para obter a porcentagem de produtividade do trabalho remoto (Mulher)
    fetch('/dashboardGestor/porcentagem-remoto-mulher')
        .then(response => response.json())
        .then(data => {
            if (data && data.porcentagemRemoto !== undefined) {
                document.getElementById('porcentagem-remoto-mulher').textContent = data.porcentagemRemoto + '%';
            }
        })
        .catch(error => console.error('Erro ao buscar a porcentagem do remoto (Mulher):', error));

    // Requisição para obter a porcentagem de produtividade do trabalho presencial (Mulher)
    fetch('/dashboardGestor/porcentagem-presencial-mulher')
        .then(response => response.json())
        .then(data => {
            if (data && data.porcentagemPresencial !== undefined) {
                document.getElementById('porcentagem-presencial-mulher').textContent = data.porcentagemPresencial + '%';
            }
        })
        .catch(error => console.error('Erro ao buscar a porcentagem do presencial (Mulher):', error));

    fetch('/dashboardGestor/media-produtividade-equipe')
        .then(response => response.json())
        .then(data => {
            if (data && data.mediaProdutividadeEquipe !== undefined) {
                document.getElementById('media-produtividade-equipe').textContent = data.mediaProdutividadeEquipe;
            }
        })
        .catch(error => console.error('Erro ao buscar a média de produtividade da equipe do remoto:', error));


    // Gráfico de utilização de recuros
    const ctx2 = document.getElementById('graficoRecursos').getContext('2d');
    
    const resourceUsageChart = new Chart(ctx2, {
        type: 'bar', // Tipo de gráfico: barras
        data: {
            labels: ['Remoto', 'Presencial'], // Labels de categoria
            datasets: [
                {
                    label: 'Tempo Pessoal',
                    data: [0, 0], // Dados para "Tempo Pessoal"
                    backgroundColor: '#0A2F5C', // Azul escuro
                    borderRadius: 5
                },
                {
                    label: 'Trabalho',
                    data: [0, 0], // Dados para "Tempo de Trabalho"
                    backgroundColor: '#0A82B0', // Azul claro
                    borderRadius: 5
                }
            ]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
                legend: {
                    display: true,
                    position: 'top',
                    labels: {
                        color: '#333',
                        font: {
                            size: 14
                        }
                    }
                },
                title: {
                    display: false
                }
            },
            scales: {
                x: {
                    beginAtZero: true,
                    grid: {
                        display: false
                    },
                    ticks: {
                        color: '#333',
                        font: {
                            size: 14
                        }
                    }
                },
                y: {
                    beginAtZero: true,
                    max: 10,
                    grid: {
                        color: '#e0e0e0'
                    },
                    ticks: {
                        stepSize: 2,
                        color: '#333',
                        font: {
                            size: 14
                        }
                    }
                }
            }
        }
    });

    
</script>

<script>
    const slider = document.getElementById('medidor');
    const resultadoTexto = document.getElementById('resultadoTexto');
    const valorSlider = document.getElementById('valorSlider');

    // Definindo o valor inicial
    valorSlider.textContent = slider.value;

    // Função para ajustar a classificação de acordo com o valor
    function atualizarClassificacao() {
        const valor = parseFloat(slider.value);

        if (valor < 2) {
            resultadoTexto.textContent = 'Ruim';
            resultadoTexto.style.color = 'red';
        } else if (valor < 3.5) {
            resultadoTexto.textContent = 'Regular';
            resultadoTexto.style.color = 'orange';
        } else if (valor < 4.5) {
            resultadoTexto.textContent = 'Bom';
            resultadoTexto.style.color = 'green';
        } else {
            resultadoTexto.textContent = 'Excelente';
            resultadoTexto.style.color = 'darkgreen';
        }
    }

    // Atualiza a classificação assim que a página carrega
    atualizarClassificacao();

    // Adiciona o evento de 'input' para atualizar a classificação em tempo real (caso o slider não esteja desabilitado)
    slider.addEventListener('input', function () {
        valorSlider.textContent = slider.value; // Exibe o valor atual
        atualizarClassificacao(); // Atualiza a classificação
    });

</script>